{% extends "base.html" %}
{% block title %}æ¨å¹¿èµšé’±{% endblock %}

{% block head %}
<style>
    .invite-header {
        background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
        padding: 3rem 1rem; text-align: center; border-radius: 0 0 20px 20px;
        margin-bottom: 2rem; color: #d00000;
    }
    .invite-card {
        background: white; border-radius: 15px; padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 1.5rem; text-align: center;
    }
    .link-box {
        background: #f8f9fa; border: 1px dashed #ccc; padding: 10px;
        border-radius: 8px; word-break: break-all; font-family: monospace;
        margin: 1rem 0; font-size: 0.9rem;
    }
    .team-list { max-height: 300px; overflow-y: auto; text-align: left; }
    .team-item {
        display: flex; justify-content: space-between; padding: 10px 0;
        border-bottom: 1px solid #eee; font-size: 0.9rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="invite-header">
    <h2 class="fw-bold mb-2">é‚€è¯·å¥½å‹ èººèµšææˆ</h2>
    <p class="mb-0 opacity-75">å¥½å‹åšä»»åŠ¡ï¼Œæ‚¨å¾— 10% æ°¸ä¹…ææˆ</p>
</div>

<div class="invite-card mx-3" style="margin-top: -3rem;">
    <h5 class="fw-bold">ğŸš€ æ‚¨çš„ä¸“å±æ¨å¹¿é“¾æ¥</h5>
    <div class="link-box" id="inviteLink">
        {{ base_url }}/register?invite={{ user.id }}
    </div>
    <button onclick="copyLink()" class="btn btn-red w-100 rounded-pill shadow-sm">
        <i class="fas fa-copy me-1"></i> å¤åˆ¶é“¾æ¥å»åˆ†äº«
    </button>
</div>

<div class="invite-card mx-3">
    <div class="d-flex justify-content-between mb-3">
        <h5 class="fw-bold mb-0">ğŸ‘¥ æˆ‘çš„å›¢é˜Ÿ</h5>
        <span class="badge bg-danger rounded-pill">{{ children|length }} äºº</span>
    </div>
    
    <div class="team-list">
        {% for child in children %}
        <div class="team-item">
            <div>
                <i class="fas fa-user text-muted me-2"></i>
                <span class="fw-bold">{{ child.username }}</span>
                <span class="text-muted small ms-1">(ID: {{ child.id }})</span>
            </div>
            <div class="text-muted small">
                {{ child.created_at.strftime('%m-%d') }} åŠ å…¥
            </div>
        </div>
        {% else %}
        <div class="text-center py-4 text-muted small">
            è¿˜æ²¡æœ‰é‚€è¯·åˆ°å¥½å‹ï¼Œå¿«å»åˆ†äº«å§ï¼
        </div>
        {% endfor %}
    </div>
</div>

<div class="text-center mb-5">
    <a href="/h5/mine" class="text-decoration-none text-muted">
        <i class="fas fa-arrow-left me-1"></i> è¿”å›ä¸ªäººä¸­å¿ƒ
    </a>
</div>

<div class="modal fade" id="copyModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content text-center p-3">
            <i class="fas fa-check-circle text-success fa-3x mb-2"></i>
            <p class="mb-0 fw-bold">é“¾æ¥å·²å¤åˆ¶ï¼</p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function copyLink() {
        var copyText = document.getElementById("inviteLink");
        var range = document.createRange();
        range.selectNode(copyText);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand("copy");
        window.getSelection().removeAllRanges();
        
        var myModal = new bootstrap.Modal(document.getElementById('copyModal'));
        myModal.show();
        setTimeout(function(){ myModal.hide(); }, 1500);
    }
</script>
{% endblock %}
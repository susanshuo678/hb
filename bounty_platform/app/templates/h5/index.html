{% extends "base.html" %}
{% block title %}‰ªªÂä°Â§ßÂéÖ{% endblock %}

{% block head %}
<style>
    .banner-container { border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 1rem; }
    .carousel-item img { width: 100%; height: 160px; object-fit: cover; }
    .notice-bar { background: #fff5eb; color: #d35400; padding: 0.5rem 1rem; border-radius: 8px; font-size: 0.9rem; margin-bottom: 1rem; display: flex; align-items: center; }
    .notice-icon { margin-right: 0.5rem; animation: bell-shake 2s infinite; }
    
    .category-nav { display: flex; overflow-x: auto; white-space: nowrap; padding-bottom: 10px; margin-bottom: 10px; -webkit-overflow-scrolling: touch; }
    .category-nav::-webkit-scrollbar { display: none; }
    
    .cat-item { display: inline-block; padding: 8px 16px; margin-right: 10px; background: white; border-radius: 20px; color: #666; font-size: 0.9rem; border: 1px solid #eee; text-decoration: none; transition: all 0.2s; }
    .cat-item.active { background: #d00000; color: white; border-color: #d00000; font-weight: bold; box-shadow: 0 4px 10px rgba(208,0,0,0.3); }
    
    .task-card { background: white; border-radius: 12px; padding: 1rem; margin-bottom: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.02); border: 1px solid #f0f0f0; transition: transform 0.2s; }
    .task-card:active { transform: scale(0.98); }
    
    .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #eee; display: flex; justify-content: space-around; padding: 0.8rem 0; z-index: 999; }
    .nav-item { text-align: center; color: #999; text-decoration: none; font-size: 0.8rem; }
    .nav-item.active { color: #d00000; font-weight: bold; }
    .nav-item i { display: block; font-size: 1.4rem; margin-bottom: 0.2rem; }
    @keyframes bell-shake { 0%, 100% { transform: rotate(0); } 10%, 30%, 50% { transform: rotate(15deg); } 20%, 40% { transform: rotate(-15deg); } }
</style>
{% endblock %}

{% block content %}
{% if popup_content %}
<div class="modal fade" id="homePopup" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold">üì¢ ÂÖ¨Âëä</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="bg-light p-3 rounded">
                    {{ popup_content | safe }}
                </div>
            </div>
            <div class="modal-footer border-0 pt-0">
                <button type="button" class="btn btn-danger w-100 rounded-pill" data-bs-dismiss="modal">ÊàëÁü•ÈÅì‰∫Ü</button>
            </div>
        </div>
    </div>
</div>
{% endif %}

{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var popupContent = `{{ popup_content }}`;
        if (!popupContent) return;

        // üü¢ ÊØèÊó•Âè™Âºπ‰∏ÄÊ¨°ÈÄªËæë
        var today = new Date().toISOString().slice(0, 10); // 2026-01-17
        var lastPop = localStorage.getItem("last_popup_date");
        
        if (lastPop !== today) {
            var myModal = new bootstrap.Modal(document.getElementById('homePopup'));
            myModal.show();
            localStorage.setItem("last_popup_date", today);
        }
    });
</script>
{% endblock %}